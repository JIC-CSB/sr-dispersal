{% extends "dispersal/base.html" %}
{% load crispy_forms_tags %}
{% load static %}

{% block content %}
    <script>
        function myFunction(){
            var x = document.getElementById("weather");
            if (x.style.display == "none") {
                x.style.display = "block";
            } else {
                x.style.display = "none";
            }
        }
    </script>
    <link rel="stylesheet" href="css/rSlider.min.css">
    <script src="js/rSlider.min.js"></script>
    <script>
        var mySlider = new rSlider({
            target: '#slider',
            values:[1,10,20,30,40,50,60,70,80,90,100],
            range:  true
            set:    null,
            width:  null,
            scale:  true,
            labels: true,
            tooltip:    true,
            step:    null,
        })
    </script>


    <div>
    	<h2> This is the page to run the model</h2>
    	<h4> Please, input the following values and click submit </h4>
    </div>
	{% if error_message %}<p><strong>{{ error_message }}</strong></p>{% endif %}

    <form action="results" method=post">
	{% csrf_token %}
    <!-- <div class="form-group">
        <table>
            {{ form|crispy }}
        </table>
    </div> -->
    {{ form.non_field_errors }}
    {% for hidden_field in form.hidden_fields %}
        {{ hidden_field.errors}}
        {{ hidden_field }}
    {% endfor %}
    <h3>* Input the infection level of the source</h3>
    <div class="form-row">
        <div class="form-group col-md-6 mb-0">
            {{ form.source | as_crispy_field }}
        </div>
        <div class="form-group col-md-6 mb-0">
            {{ form.height | as_crispy_field }}
        </div>
    </div>
    <div class="form-row">
        <div class="slidecontainer col-md-3 mb-0">
            <strong>Percentage of Leaf Infected</strong>
            <!-- <input type="range" min="1" max="100" value="1" class="slider"
            id="myRange-leaf" name="leafperc"> -->
            <input type="range" min="1" max="100" value="1" class="slider"
            id="myRange-leaf" name="leafperc">
            <p>Value: <span id="demo-leaf"></span>%</p>
        </div>
        <div class="form-group col-md-3 mb-0">
            <img src="{% static 'images/leaf1.png' %}" alt="leaf" id="img-leaf" class="img-leaf">
            <script>
                var slider = document.getElementById("myRange-leaf");
                var output = document.getElementById("demo-leaf");
                output.innerHTML = slider.value;

                slider.oninput = function() {
                    output.innerHTML = this.value;
                    var img = document.getElementById("img-leaf");
                    if (this.value < 10) {
                        img.setAttribute("src","{% static 'images/leaf1.png' %}") ;
                    } else if(this.value < 25) {
                        img.setAttribute("src","{% static 'images/leaf10.png' %}") ;
                    } else if(this.value < 50) {
                        img.setAttribute("src","{% static 'images/leaf25.png' %}") ;
                    } else if(this.value < 75) {
                        img.setAttribute("src","{% static 'images/leaf50.png' %}") ;
                    } else if(this.value < 90) {
                        img.setAttribute("src","{% static 'images/leaf75.png' %}") ;
                    } else {
                        img.setAttribute("src","{% static 'images/leaf100.png' %}") ;
                    }
                }
            </script>
        </div>
    <!-- </div> -->

    <!-- <div class="form-row"> -->
        <div class="slidecontainer col-md-3 mb-0">
            <strong>Percentage of Bush Infected</strong>
            <input type="range" min="1" max="100" value="1" class="slider-bush"
            id="bush" name="bushperc">
            <p>Value: <span id="bushvalue"></span>%</p>
        </div>
        <div class="form-group col-md-3 mb-0">
            <img src="{% static 'images/bush1.png' %}" alt="bush" id="img-bush" class="img-bush">
            <!-- <img src="{{STATIC_URL}}images/leaf1.png" alt="leaf" id="img"> -->
            <script>
                var sliderbush = document.getElementById("bush");
                var outputbush = document.getElementById("bushvalue");
                outputbush.innerHTML = sliderbush.value;

                sliderbush.oninput = function() {
                    outputbush.innerHTML = this.value;
                    var img = document.getElementById("img-bush");
                    if (this.value < 10) {
                        img.setAttribute("src","{% static 'images/bush1.png' %}") ;
                    } else if(this.value < 25) {
                        img.setAttribute("src","{% static 'images/bush10.png' %}") ;
                    } else if(this.value < 35) {
                        img.setAttribute("src","{% static 'images/bush25.png' %}") ;
                    } else if(this.value < 50) {
                        img.setAttribute("src","{% static 'images/bush35.png' %}") ;
                    } else if(this.value < 60) {
                        img.setAttribute("src","{% static 'images/bush50.png' %}") ;
                    } else if(this.value < 75) {
                        img.setAttribute("src","{% static 'images/bush60.png' %}") ;
                    } else if(this.value < 80) {
                        img.setAttribute("src","{% static 'images/bush75.png' %}") ;
                    } else if(this.value < 90) {
                        img.setAttribute("src","{% static 'images/bush80.png' %}") ;
                    } else if(this.value < 94) {
                        img.setAttribute("src","{% static 'images/bush90.png' %}") ;
                    } else if(this.value < 97) {
                        img.setAttribute("src","{% static 'images/bush95.png' %}") ;
                    } else {
                        img.setAttribute("src","{% static 'images/bush100.png' %}") ;
                    }
                }
            </script>
        </div>
    </div>
    <h3>* Input location and collect weather data real time</h3>
            <!-- <button onclick="myFunction()">Here</button> -->
    <div class="form-row">
        <div class="form-group col-md-6 mb-0">
            {{ form.country | as_crispy_field }}
        </div>
        <div class="form-group col-md-6 mb-0">
            {{ form.city | as_crispy_field }}
        </div>
    </div>

    <div class="form-row">
        <div class="form-group col-md-6 mb-0">
            <h3>* Input weather data yourself</h3>
            <!-- Rounded switch -->
            <label class="switch">
              <input type="checkbox" onchange="myFunction()">
              <span class="slider-round round"></span>
            </label>
        </div>

    </div>
    <div class="form-row" id="weather" style="display:none;">
        <div class="form-group col-md-6 mb-0">
            {{ form.wind | as_crispy_field }}
        </div>
        <div class="form-group col-md-6 mb-0">
            {{ form.cloudiness | as_crispy_field }}
        </div>

    </div>
    <p style="color:white;">  .</p>

    <div class="form-row">
        <div class="form-group col-md-5 mb-0">
            <h4>Please submit the form to run the model and see the results.   </h4>
        </div>
        <div class="form-group col-md-2 mb-0">
            <button type="submit" class="btn btn-primary" value="OK">Submit</button>
        </div>

    </div>
</form>
<div class="form-row">
</div>
<div class="form-row">
</div>
 {% endblock %}
